#!/bin/bash

pushd $(dirname $0) 2>&1 > /dev/null
OUTPUT="fulldb.$(date +%Y%m%d).csv"
echo "Downloading to $(pwd)/$OUTPUT"

curl 'https://ssd.jpl.nasa.gov/sbdb_query.cgi' -H 'Referer: https://ssd.jpl.nasa.gov/sbdb_query.cgi' -H 'Origin: https://ssd.jpl.nasa.gov' -H 'Upgrade-Insecure-Requests: 1' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryqJOW2UTy3isyLVw7' --data-binary $'------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="obj_group"\r\n\r\nall\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="obj_kind"\r\n\r\nall\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="obj_numbered"\r\n\r\nall\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="OBJ_field"\r\n\r\n0\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="OBJ_op"\r\n\r\n0\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="OBJ_value"\r\n\r\n\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="ORB_field"\r\n\r\n0\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="ORB_op"\r\n\r\n0\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="ORB_value"\r\n\r\n\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="c_fields"\r\n\r\nAaAbAcAdAeAfAgAhAiAjAkAlAmAnAoApAqArAsAtAuAvAwAxAyAzBaBbBcBdBeBfBgBhBiBjBkBlBmBnBoBpBqBrBsBtBuBvBwBxByBzCaCbCcCdCeCfCgChCiCjCkClCmCnCoCpCqCrCsCtCuCvCw\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="table_format"\r\n\r\nCSV\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="max_rows"\r\n\r\n10\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="format_option"\r\n\r\ncomp\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name="query"\r\n\r\nGenerate Table\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nformat_option\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nfield_list\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nobj_kind\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nobj_group\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nobj_numbered\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nast_orbit_class\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\ntable_format\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nOBJ_field_set\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\nORB_field_set\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\npreset_field_set\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7\r\nContent-Disposition: form-data; name=".cgifields"\r\n\r\ncom_orbit_class\r\n------WebKitFormBoundaryqJOW2UTy3isyLVw7--\r\n' --compressed > $OUTPUT

popd 2>&1 > /dev/null
echo "Done."
